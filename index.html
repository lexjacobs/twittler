<!DOCTYPE html>
<html>

<head>
  <link href="style.css" media="all" rel="stylesheet" type="text/css" />
  <script src="jquery.js"></script>
  <script src="data_generator.js"></script>
</head>

<body>
  <script>
    $(document).ready(function () {
      
      // jquery variable
      var $body = $('body');
      
      // clears the screen
      // $body.html('');
      $("<div class = 'container'></div>").appendTo('body');
      $("<div class='divRight'></div>").appendTo('.container');
      $("<div class = 'divLeft' ></div>").appendTo('.container');
      $("<p class = 'title'>TWITTLER!</p><br><button class = \'fetch\' >Fetch!</button>").appendTo('.divLeft');  

      

      
      // variable that will be used to see how many have come in since last published
      var tweetsPrinted = 0;

      var tweetChecker = function () {
        var totalTweets = streams.home.length; // to check for new tweets

        if (tweetsPrinted !== totalTweets) {
          tweetDiff = totalTweets - tweetsPrinted;
          // tweetsPrinted = totalTweets;
          while (tweetDiff > 0) {
            var index = streams.home.length - tweetDiff;
            var tweet = streams.home[index];
            var $tweet = $('<p></p>');

            // first text element prepends database tweet number for TESTING only:
            $tweet.text(streams.home.indexOf(tweet)+1 + ' @' + tweet.user + ': ' + tweet.message + " at: " + tweet.created_at);
            $tweet.prependTo($('.divRight'));
            tweetDiff -= 1;
          }
        tweetsPrinted = totalTweets;
        }
      };

      // run tweetChecker initially, then every x milliseconds:
      tweetChecker();
      
      $('button').on('click', tweetChecker);
      
      // log number of unread messages. TODO: feed an 'unread message' count
      setInterval(function(){
        console.log(streams.home.length);
        } , 1000);

    });
  </script>
</body>

</html>
